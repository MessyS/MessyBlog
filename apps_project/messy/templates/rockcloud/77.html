<p></p><p>【教学资源类别】</p><table border="1" cellspacing="0" style="width:100.0%">	<tbody>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>序号</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>类别</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>打勾&radic;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>1</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>学习资源</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&radic;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>2</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>单兵模式赛题资源</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>3</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>分组对抗赛题资源</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&nbsp;</p>			</td>		</tr>	</tbody></table><p>&nbsp;【教学资源名称】&nbsp;</p><p>网络协议分析-VLAN协议分析</p><p>&nbsp;【教学资源分类】</p><table border="1" cellspacing="0" style="width:100.0%">	<tbody>		<tr>			<td style="height:14.0pt; width:25.1%">			<p>一级大类</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>二级大类</p>			</td>			<td style="height:14.0pt; width:19.12%">			<p>打勾&radic;</p>			</td>		</tr>		<tr>			<td rowspan="5" style="height:14.0pt; width:25.1%">			<p>1.安全标准</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>法律法规</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>行业标准</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>安全意识</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>应急响应</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>安全评估</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td rowspan="2" style="height:14.0pt; width:25.1%">			<p>2.系统安全</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>Windows操作系统安全配置</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>Linux操作系统安全配置</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td rowspan="2" style="height:14.0pt; width:25.1%">			<p>3.网络安全</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>网络设备安全</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>网络协议分析</p>			</td>			<td style="height:14.0pt; width:19.12%">			<p>&radic;</p>			</td>		</tr>		<tr>			<td rowspan="7" style="height:14.0pt; width:25.1%">			<p>4.应用安全</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>Web应用安全</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>数据库安全</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>中间件应用安全</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>应用层协议分析</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>移动应用安全</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>VPN应用</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>恶意代码分析</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td rowspan="2" style="height:14.0pt; width:25.1%">			<p>5.密码学</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>密码学原理</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>密码学应用</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td rowspan="3" style="height:14.0pt; width:25.1%">			<p>6.渗透测试</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>常用工具</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>脚本编写</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>报告编写</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>	</tbody></table><p>【难度说明】</p><table border="1" cellspacing="0" style="width:100.0%">	<tbody>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>序号</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>难度等级</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>打勾&radic;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>1</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>简单</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>2</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>一般</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&radic;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>3</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>困难</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>4</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>极难</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&nbsp;</p>			</td>		</tr>	</tbody></table><p>【背景描述】</p><p>XX企业，为加强信息化建设，组建了企业内部网络，用于自身网站的建设，小王是该企业新进网管，承担网络的管理工作。</p><p>现该企业网络存在如下需求：</p><p>通过企业网络SYSLOG服务分析，经常发现网络中出现VLAN跳跃攻击，造成跨VLAN的ARP欺骗，针对此问题，需要分析VLAN跳跃攻击产生的原因以及提出针对此攻击的解决方案，在此之前，需要首先对IEEE802.1Q标准的工作原理进行研究。</p><p>【实训设备】</p><table border="1" cellspacing="0">	<tbody>		<tr>			<td style="vertical-align:top; width:4.0cm">			<p>产品型号</p>			</td>			<td style="vertical-align:top; width:199.5pt">			<p>产品描述</p>			</td>			<td style="vertical-align:top; width:69.8pt">			<p>数量</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:4.0cm">			<p>PY-P8</p>			</td>			<td style="vertical-align:top; width:199.5pt">			<p>实训室安全、应用环境实训平台</p>			</td>			<td style="vertical-align:top; width:69.8pt">			<p>1</p>			</td>		</tr>	</tbody></table><p>【预备知识】</p><p>&nbsp;&nbsp;&nbsp; IEEE 802.1q协议为标识带有VLAN成员信息的以太帧建立了一种标准方法。IEEE802.1q标准定义了VLAN网桥操作，从而允许在桥接局域网结构中实现定义、运行以及管理VLAN拓朴结构等操作。IEEE 802.1q标准主要用来解决如何将大型网络划分为多个小网络，如此广播和组播流量就不会占据更多带宽的问题。此外IEEE 802.1q标准还提供更高的网络段间安全性。IEEE802.1q完成这些功能的关键在于标签。支持IEEE 802.1q的交换端口可被配置来传输标签帧或无标签帧。一个包含VLAN信息的标签字段可以插入到以太帧中。如果端口有支持IEEE 802.1q的设备（如另一个交换机）相连，那么这些标签帧可以在交换机之间传送VLAN成员信息，这样VLAN就可以跨越多台交换机。但是，对于没有支持IEEE 802.1q设备相连的端口我们必须确保它们用于传输无标签帧，这一点非常重要。很多PC和打印机的NIC并不支持IEEE 802.1q，一旦它们收到一个标签帧，它们会因为读不懂标签而丢弃该帧。在IEEE 802.1q中，用于标签帧的最大合法以太帧大小已由1518字节增加到1522字节，这样就会使网卡和旧式交换机由于帧&ldquo;尺寸过大&rdquo;而丢弃标签帧。</p><p>&nbsp;&nbsp;&nbsp; Preamble（Pre）：前导字段，7字节。Pre字段中1和0交互使用，接收站通过该字段知道导入帧，并且该字段提供了同步化接收物理层帧接收部分和导入比特流的方法。</p><p>Start-of-Frame Delimiter（SFD）：帧起始分隔符字段，1字节。字段中1和0交互使用，结尾是两个连续的1，表示下一位是利用目的地址的重复使用字节的重复使用位。</p><p>Destination Address（DA）：目的地址字段，6字节。DA字段用于识别需要接收帧的站。</p><p>Source Addresses（SA）：源地址字段，6字节。SA字段用于识别发送帧的站。</p><p>TPID：标记协议标识字段，2个字节，值为8100（hex）。当帧中的EtherType（以太网类型）字段值也为8100时，该帧传送标签IEEE 802.1q/802.1p。</p><p>TCI：标签控制信息字段，包括用户优先级（User Priority）、规范格式指示器（Canonical Format Indicator，CFI）和VLAN ID。</p><p>说明：&ldquo;User Priority&rdquo;定义用户优先级，包括8个（2^3）优先级别。IEEE 802.1p为3比特的用户优先级位定义了操作。&ldquo;CFI&rdquo;，在以太网交换机中，规范格式指示器总被设置为0。由于兼容特性，CFI常用于以太网类网络和令牌环类网络之间，如果在以太网端口接收的帧具有CFI，那么设置为1，表示该帧不进行转发，这是因为以太网端口是一个无标签端口。&ldquo;VID&rdquo;（VLAN ID）是对VLAN的识别字段，在标准IEEE 802.1q中常被使用。该字段为12位。支持4096（2^12）VLAN的识别。在4096可能的VID中，VID=0用于识别帧优先级。 4095（FFF）作为预留值，所以VLAN配置的最大可能值为4094。</p><p>Length/Type：长度/类型字段，2字节。如果是采用可选格式组成帧结构时，该字段既表示包含在帧数据字段中的MAC客户机数据大小，也表示帧类型ID。</p><p>Data：数据字段，是一组n（46&le;n&le;1500）字节的任意值序列。帧总值最小为64字节。</p><p>Frame Check Sequence（FCS）：帧校验序列字段，4字节。该序列包括32位的循环冗余校验（CRC）值，由发送MAC方生成，通过接收MAC方进行计算得出以校验被破坏的帧。</p><p>【实验步骤】</p><p>网络拓扑：BackTrack5--CentOS</p><p>centos<br />用户：root<br />密码：root</p><p>bt5&nbsp;<br />用户：root<br />密码：toor</p><p>第一步：为各主机配置IP地址</p><p>Ubuntu Linux：</p><p>IPA：192.168.1.112/24</p><p>CentOS Linux：</p><p>IPB：192.168.1.100/24</p><p>第二步：从渗透测试主机开启Python3.3解释器</p><p>&nbsp;</p><p>&nbsp;</p><p>第三步：在渗透测试主机Python解释器中导入Scapy库</p><p>&nbsp;</p><p>&nbsp;</p><p>第四步：查看Scapy库中支持的类</p><p>&hellip;&hellip;</p><p>&nbsp;</p><p>第五步：实例化Ether类的一个对象，对象的名称为eth，查看对象eth的各属性</p><p>第六步：实例化Dot1Q类的一个对象，对象的名称为dot1q，查看对象dot1q的各属性</p><p>第七步：实例化ARP类的一个对象，对象的名称为arp，查看对象arp的各属性</p><p>第八步：将对象联合eth、dot1q、arp构造为复合数据类型packet，并查看对象packet的各个属性</p><p>第九步：将packet[Ether].src赋值为本地MAC地址，将packet[Ether].dst赋值为广播MAC地址&ldquo;FF:FF:FF:FF:FF:FF&rdquo;，并验证</p><p>第十步：将packet[Dot1Q].vlan、packet[ARP].psrc、packet[ARP].pdst分别赋值，并验证</p><p>第十一步：打开WireShark程序，并设置过滤条件</p><p>&nbsp;</p><p>第十二步：通过sendp（）函数将对象packet进行发送</p><p>&nbsp;</p><p>第十三步：查看WireShark捕获到的packet对象，对照预备知识，分析VLAN协议数据对象</p><p>1、Ether</p><p>2、Dot1Q</p><p>3、ARP</p><p>&nbsp;</p><p>&nbsp;</p><p>实验结束，关闭虚拟机。</p>
<p></p><p>【教学资源类别】</p><table border="1" cellspacing="0" style="width:0px">	<tbody>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p><strong>序号</strong></p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p><strong>类别</strong></p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p><strong>打勾&radic;</strong></p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p>1</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>学习资源</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p><strong>&radic;</strong></p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p>2</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>单兵模式赛题资源</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p>3</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>分组对抗赛题资源</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>&nbsp;</p>			</td>		</tr>	</tbody></table><p>&nbsp;【教学资源名称】&nbsp;</p><p>渗透测试常用工具-使用tcpdump进行数据包抓取</p><p>&nbsp;【教学资源分类】</p><table border="1" cellspacing="0" style="width:0px">	<tbody>		<tr>			<td style="height:14.0pt; width:106.95pt">			<p><strong>一级大类</strong></p>			</td>			<td style="height:14.0pt; width:237.7pt">			<p><strong>二级大类</strong></p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p><strong>打勾&radic;</strong></p>			</td>		</tr>		<tr>			<td rowspan="5" style="height:14.0pt; width:106.95pt">			<p>1.安全标准</p>			</td>			<td style="height:14.0pt; width:237.7pt">			<p>法律法规</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>行业标准</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>安全意识</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>应急响应</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>安全评估</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td rowspan="2" style="height:14.0pt; width:106.95pt">			<p>2.系统安全</p>			</td>			<td style="height:14.0pt; width:237.7pt">			<p>Windows操作系统安全配置</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>Linux操作系统安全配置</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td rowspan="2" style="height:14.0pt; width:106.95pt">			<p>3.网络安全</p>			</td>			<td style="height:14.0pt; width:237.7pt">			<p>网络设备安全</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>网络协议分析</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td rowspan="7" style="height:14.0pt; width:106.95pt">			<p>4.应用安全</p>			</td>			<td style="height:14.0pt; width:237.7pt">			<p>Web应用安全</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>数据库安全</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:18.35pt; width:237.7pt">			<p>中间件应用安全</p>			</td>			<td style="height:18.35pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>应用层协议分析</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p><strong>&radic;</strong></p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>移动应用安全</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>VPN应用</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>恶意代码分析</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td rowspan="2" style="height:14.0pt; width:106.95pt">			<p>5.密码学</p>			</td>			<td style="height:14.0pt; width:237.7pt">			<p>密码学原理</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>密码学应用</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td rowspan="3" style="height:14.0pt; width:106.95pt">			<p>6.渗透测试</p>			</td>			<td style="height:14.0pt; width:237.7pt">			<p>常用工具</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p><strong>&radic;</strong></p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>脚本编写</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>报告编写</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>	</tbody></table><p>【难度说明】</p><table border="1" cellspacing="0" style="width:0px">	<tbody>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p><strong>序号</strong></p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p><strong>难度等级</strong></p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p><strong>打勾&radic;</strong></p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p>1</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>简单</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p><strong>&radic;</strong></p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p>2</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>一般</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p>3</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>困难</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p>4</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>极难</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>&nbsp;</p>			</td>		</tr>	</tbody></table><p>【背景描述】</p><p>某网站站长被云主机运营商通知，告知其主机正在被ICMP流量攻击，该站长为了确定</p><p>消息的真实性，使用tcpdump对自己VPS进行了抓包分析。</p><p>&nbsp;【实训设备】</p><table border="1" cellspacing="0" style="width:0px">	<tbody>		<tr>			<td style="vertical-align:top; width:146.65pt">			<p>产品型号</p>			</td>			<td style="vertical-align:top; width:166.25pt">			<p>产品描述</p>			</td>			<td style="vertical-align:top; width:69.8pt">			<p>数量</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:146.65pt">			<p>PY-P8</p>			</td>			<td style="vertical-align:top; width:166.25pt">			<p>实训室安全、应用环境实训平台</p>			</td>			<td style="vertical-align:top; width:69.8pt">			<p>1</p>			</td>		</tr>	</tbody></table><p><strong>【靶机】</strong></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 操作系统：Windows Server 2003</p><p>【<strong>渗透测试机</strong>】</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 操作系统：Backtrack5 R3</p><p>&nbsp;&nbsp; <strong>【工具集】</strong></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fping</p><p>【预备知识】</p><p>Linux作为网络服务器，特别是作为路由器和网关时，数据的采集和分析是不可少的。TcpDump是</p><p>Linux中强大的网络数据采集分析工具之一。</p><p>用简单的话来定义tcpdump，就是：dump the traffic on a network，根据使用者的定义对网络上的</p><p>数据包进行截获的包分析工具。</p><p>作为互联网上经典的的系统管理员必备工具，tcpdump以其强大的功能，灵活的截取策略，成为每个</p><p>高级的系统管理员分析网络，排查问题等所必备的工具之一。</p><p>tcpdump提供了源代码，公开了接口，因此具备很强的可扩展性，对于网络维护和入侵者都是非常有</p><p>用的工具。tcpdump存在于基本的 FreeBSD系统中，由于它需要将网络接口设置为混杂模式，普通用</p><p>户不能正常执行，但具备root权限的用户可以直接执行它来获取网络上的信息。因此系统中存在网络分析工具主要不是对本机安全的威胁，而是对网络上的其他计算机的安全存在威胁。</p><p>基本上tcpdump的总的输出格式为：系统时间 来源主机.端口 &gt; 目标主机.端口 数据包参数</p><p>&nbsp;</p><p>【实验步骤】</p><p>&nbsp;&nbsp;网络拓扑：bt5--01-server2003</p><p>&nbsp; bt5&nbsp;<br />&nbsp; 用户：root<br />&nbsp; 密码：toor</p><p>&nbsp; windows server 2003<br />&nbsp; 用户：administrator<br />&nbsp; 密码：123456</p><p><strong>【第一步】点击启动选项，启动实验虚拟机。</strong></p><p><strong>【第二步】获取操作机和靶机的IP</strong></p><p>&nbsp;&nbsp; 操作机：<strong>ifconfig</strong></p><p>靶机：ipconfig</p><p>&nbsp; 【<strong>使用到的命令</strong>】</p><p>BT5：通过ifconfig获取</p><p>Windows Server：通过ipconfig获取</p><p><strong>【第三步】打开终端窗口，ifconfig命令查看网卡编号</strong></p><p>此处网卡为eth0</p><p>&nbsp;</p><p><strong>【第四步】执行tcpdump -help 来看一下帮助信息</strong></p><p><strong>【所使用到的命令】</strong></p><p>【tcpdump -help】显示帮助信息</p><p><strong>【第五步】：抓取网卡上所有流量</strong></p><p>直接就运行tcpdump将会抓取网卡上所有流量，值得一提的是tcpdump过滤功能的灵活性，</p><p>下面我们就简单介绍一下tcpdump常用方法。</p><p>【tcpdump -i eth0】-i interface指定网卡接口</p><p>【src】来源协议</p><p>【host】指定主机192.168.0.180</p><p>&nbsp;<img src="api/attachment?type=courseDocument&amp;id=1340" style="height:68px; width:518px" /></p><p><strong>【所使用到的命令】</strong></p><p>【tcpdump -i eth0 src host 192.168.0.180】：监听并过滤出源地址为192.168.0.180</p><p>主机的流量</p><p><strong>【第六步】使用windows发送ping【使用ICMP协议】包</strong></p><p><strong>【所使用到的命令】</strong></p><p>【ping 192.168.0.180】&nbsp;</p><p>【-t】持续向主机192.168.0.180发送icmp请求</p><p><strong>【第七步】查看tcpdump所获取到的数据包信息</strong></p><p>我们看到此处抓到的包是192.168.0.180发送至192.168.0.106,包的类型为reply响应包</p><p>&nbsp;</p><p><strong>【第八步】修改流量动作来源</strong></p><p>[a].我们结束掉当前的tcpdump【ctrl+c】</p><p>[b].将src【来源】改为dst【外出】</p><p>[c].tcpdump -i eth0 dst【将src修改为dst】 host 192.168.0.180，</p><p>通过下图可以看到包的类型变成了request,从响应包【reply】变成了请求包【request】</p><p><strong>【所使用到的命令】</strong></p><p>tcpdump -i eth0 dst&nbsp; host 192.168.0.180</p><p><strong>【第九步】分析</strong></p><p>上面我们提到了src和dst来过滤数据包走向以及定义了他们被显示的规则，那么想过滤出</p><p>端口大家可想而知，tcpdump -i eth0 src port 80是获取来源流量请求，tcpdump -i eth0</p><p>dst port 80就是外出流量请求80端口，如果不加src或者dst则会显示出所有和此端口</p><p>相关流量</p><p><strong>【所使用到的命令】</strong></p><p>1：tcpdump -i eth0 port 80</p><p>2：windows2003使用浏览器打开bt5的ip</p><p>3：查看BT5所抓取到的http请求信息</p><p>&nbsp;</p><p><strong>【第九步】：我们将数据包进行保存并读取</strong></p><p>使用命令将流量保存到指定文件</p><p><strong>【使用到的命令】</strong></p><p>【Tcpdump -i eth0&nbsp; -w /123456.cap】将eth0网卡的流量保存在123456.cap文件里</p><p>&nbsp;</p><p>&nbsp;</p><p><strong>【使用到的命令】</strong></p><p>【tcpdump -r /123456.cap】读取抓取到的流量包</p><p>&nbsp;</p><p>实验结束，关闭虚拟机。</p>
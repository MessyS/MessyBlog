<p></p><p>【教学资源类别】</p><table border="1" cellspacing="0" style="width:100.0%">	<tbody>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>序号</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>类别</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>打勾&radic;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>1</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>学习资源</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&radic;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>2</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>单兵模式赛题资源</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>3</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>分组对抗赛题资源</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&nbsp;</p>			</td>		</tr>	</tbody></table><p>&nbsp;【教学资源名称】&nbsp;</p><p>网络协议分析-Ethernet协议分析</p><p>&nbsp;【教学资源分类】</p><table border="1" cellspacing="0" style="width:100.0%">	<tbody>		<tr>			<td style="height:14.0pt; width:25.1%">			<p>一级大类</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>二级大类</p>			</td>			<td style="height:14.0pt; width:19.12%">			<p>打勾&radic;</p>			</td>		</tr>		<tr>			<td rowspan="5" style="height:14.0pt; width:25.1%">			<p>1.安全标准</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>法律法规</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>行业标准</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>安全意识</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>应急响应</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>安全评估</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td rowspan="2" style="height:14.0pt; width:25.1%">			<p>2.系统安全</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>Windows操作系统安全配置</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>Linux操作系统安全配置</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td rowspan="2" style="height:14.0pt; width:25.1%">			<p>3.网络安全</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>网络设备安全</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>网络协议分析</p>			</td>			<td style="height:14.0pt; width:19.12%">			<p>&radic;</p>			</td>		</tr>		<tr>			<td rowspan="7" style="height:14.0pt; width:25.1%">			<p>4.应用安全</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>Web应用安全</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>数据库安全</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>中间件应用安全</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>应用层协议分析</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>移动应用安全</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>VPN应用</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>恶意代码分析</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td rowspan="2" style="height:14.0pt; width:25.1%">			<p>5.密码学</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>密码学原理</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>密码学应用</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td rowspan="3" style="height:14.0pt; width:25.1%">			<p>6.渗透测试</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>常用工具</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>脚本编写</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>报告编写</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>	</tbody></table><p>【难度说明】</p><table border="1" cellspacing="0" style="width:100.0%">	<tbody>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>序号</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>难度等级</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>打勾&radic;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>1</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>简单</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>2</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>一般</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&radic;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>3</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>困难</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>4</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>极难</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&nbsp;</p>			</td>		</tr>	</tbody></table><p>【背景描述】</p><p>XX企业，为加强信息化建设，组建了企业内部网络，用于自身网站的建设，小王是该企业新进网管，承担网络的管理工作。</p><p>现该企业网络存在如下需求：</p><p>【实训设备】</p><table border="1" cellspacing="0">	<tbody>		<tr>			<td style="vertical-align:top; width:4.0cm">			<p>产品型号</p>			</td>			<td style="vertical-align:top; width:199.5pt">			<p>产品描述</p>			</td>			<td style="vertical-align:top; width:69.8pt">			<p>数量</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:4.0cm">			<p>PY-P8</p>			</td>			<td style="vertical-align:top; width:199.5pt">			<p>实训室安全、应用环境实训平台</p>			</td>			<td style="vertical-align:top; width:69.8pt">			<p>1</p>			</td>		</tr>	</tbody></table><p>&nbsp;</p><p>【预备知识】</p><p>常见以太网帧结构详解</p><p>以太网相关背景</p><p>以太网这个术语通常是指由DEC，Intel和Xerox公司在1982年联合公布的一个标准，它是当今TCP/IP采用的主要的局域网技术，它采用一种称作CSMA/CD的媒体接入方法。几年后，IEEE802委员会公布了一个稍有不同的标准集，其中802.3针对整个CSMA/CD网络，802.4针对令牌总线网络，802.5针对令牌环网络；此三种帧的通用部分由802.2标准来定义，也就是我们熟悉的802网络共有的逻辑链路控制（LLC）。由于目前CSMA/CD的媒体接入方式占主流，因此在此仅对以太网和IEEE 802.3的帧格式作详细的分析。</p><p>在TCP/IP世界中，以太网IP数据报文的封装在RFC 894中定义，IEEE802.3网络的IP数据报文封装在RFC 1042中定义。标准规定：</p><p>1）主机必须能发送和接收采用RFC 894（以太网）封装格式的分组；</p><p>2）主机应该能接收RFC 1042（IEEE 802.3）封装格式的分组；</p><p>3）主机可以发送采用RFC 1042（IEEE 802.3）封装格式的分组。</p><p>如果主机能同时发送两种类型的分组数据，那么发送的分组必须是可以设置的，而且默认条件下必须是RFC 894（以太网）。</p><p>&nbsp;&nbsp;最常使用的封装格式是RFC 894定义的格式，俗称Ethernet II或者Ethernet DIX。</p><p>&nbsp;&nbsp;下面，我们就以Ethernet II称呼RFC 894定义的以太帧，</p><p>&nbsp;&nbsp;以IEEE802.3称呼RFC 1042定义的以太帧。</p><p>Ethernet II和IEEE802.3的帧格式分别如下。</p><p>Ethernet II帧格式：</p><p>---------------------------------------------------------------------</p><p>|前序&nbsp; |目的地址|源地址|类型&nbsp; |数据&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |FCS&nbsp;&nbsp;|</p><p>|8 byte|6 byte&nbsp;|6 byte|2 byte|46~1500 byte&nbsp;&nbsp; | 4 byte|</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>IEEE802.3一般帧格式</p><p>--------------------------------------------------------</p><p>|前序&nbsp;|帧起始定界符|目的地址|源地址|长度 |数据&nbsp;&nbsp;&nbsp; |FCS&nbsp; |</p><p>--------------------------------------------------------------------</p><p>|7 byte|1 byte&nbsp;&nbsp; &nbsp;|2/6byte|2/6byte|2byte|46~1500byte|4byte |</p><p>&nbsp;</p><p>Ethernet II和IEEE802.3的帧格式比较类似，主要的不同点在于前者定义的2字节的类型，而后者定义的是2字节的长度；所幸的是，后者定义的有效长度值与前者定义的有效类型值无一相同，这样就容易区分两种帧格式了。</p><p>一、前序字段</p><p>前序字段由8个（Ethernet II）或7个（IEEE802.3）字节的交替出现的1和0组成，设置该字段的目的是指示帧的开始并便于网络中的所有接收器均能与到达帧同步，另外，该字段本身（在Ethernet II中）或与帧起始定界符一起（在IEEE802.3中）能保证各帧之间用于错误检测和恢复操作的时间间隔不小于9.6毫秒。</p><p>二、帧起始定界符字段</p><p>该字段仅在IEEE802.3标准中有效，它可以被看作前序字段的延续。实际上，该字段的组成方式继续使用前序字段中的格式，这个一个字节的字段的前6个比特位置由交替出现的1和0构成。该字段的最后两个比特位置是11，这两位中断了同步模式并提醒接收后面跟随的是帧数据。</p><p>当控制器将接收帧送入其缓冲器时，前序字段和帧起始定界符字段均被去除。类似地当控制器发送帧时，它将这两个字段（如果传输的是IEEE802.3帧）或一个前序字段（如果传输的是真正的以太网帧）作为前缀加入帧中。</p><p>三、目的地址字段</p><p>目的地址字段确定帧的接收者。两个字节的源地址和目的地址可用于IEEE802.3网络，而6个字节的源地址和目的地址字段既可用于Ethernet II网络又可用于IEEE802.3网络。用户可以选择两字节或六字节的目的地址字段，但对IEEE802.3设备来说，局域网中的所有工作站必须使用同样的地址结构。目前，几乎所有的802.3网络使用6字节寻址，帧结构中包含两字节字段选项主要是用于使用16比特地址字段的早期的局域网。</p><p>四、源地址字段</p><p>源地址字段标识发送帧的工作站。和目前地址字段类似，源地址字段的长度可以是两个或六个字节。只有IEEE802.3标准支持两字节源地址并要求使用的目的地址。Ethernet II和IEEE802.3标准均支持六个字节的源地址字段。当使用六个字节的源地址字段时，前三个字节表示由IEEE分配给厂商的地址，将烧录在每一块网络接口卡的ROM中。而制造商通常为其每一网络接口卡分配后字节。</p><p>五、类型字段</p><p>两字节的类型字段仅用于Ethernet II帧。该字段用于标识数据字段中包含的高层协议，也就是说，该字段告诉接收设备如何解释数据字段。在以太网中，多种协议可以在局域网中同时共存，例如：类型字段取值为十六进制0800的帧将被识别为IP协议帧，而类型字段取值为十六进制8137的帧将被识别为IPX和SPX传输协议帧。因此，在 Ethernet II的类型字段中设置相应的十六进制值提供了在局域网中支持多协议传输的机制。</p><p>在IEEE802.3标准中类型字段被替换为长度字段，因而Ethernet II帧和IEEE802.3帧之间不能兼容。</p><p>六、长度字段</p><p>用于IEEE802.3的两字节长度字段定义了数据字段包含的字节数。不论是在Ethernet II还是IEEE　802.3标准中，从前序到FCS字段的帧长度最小必须是64字节。最小帧长度保证有足够的传输时间用于以太网网络接口卡精确地检测冲突，这一最小时间是根据网络的最大电缆长度和帧沿电缆长度传播所要求的时间确定的。基于最小帧长为64字节和使用六字节地址字段的要求，意味着每个数据字段的最小长度为46字节。唯一的例外是吉比特以太网。在1000Mbit/s的工作速率下，原来的802.3标准不可能提供足够的帧持续时间使电缆长度达到100米。这是因为在1000Mbit/s的数据率下，一个工作站在发现网段另一端出现的任何冲突之前已经处在帧传输过程中的可能性很高。为解决这一问题，设计了将以太网最小帧长扩展为512字节的负载扩展方法。</p><p>对除了吉比特以太网之外的所有以太网版本，如果传输数据少于46个字节，应将数据字段填充至46字节。不过，填充字符的个数不包括在长度字段值中。同时支持以太网和IEEE802.3帧格式的网络接口卡通过这一字段的值区分这两种帧。也就是说，因为数据字段的最大长度为1500字节，所以超过十六进制数 05DC的值说明它不是长度字段（IEEE802.3).而是类型字段（Ethernet II）。</p><p>七、数据字段</p><p>如前所述，数据字段的最小长度必须为46字节以保证帧长至少为64字节，这意味着传输一字节信息也必须使用46字节的数据字段：如果填入该该字段的信息少于46字节，该字段的其余部分也必须进行填充。数据字段的最大长度为1500字节。</p><p>八、校验序列字段</p><p>既可用于Ethernet II又可用于IEE802.3标准的帧校验序列字段提供了一种错误检测机制，每一个发送器均计算一个包括了地址字段、类型/长度字段和数据字段的循环冗余校验（CRC）码。发送器于是将计算出的CRC填入四字节的FCS字段。</p><p>虽然IEEE802.3标准必然要取代Ethernet II，但由于二者的相似以及Ethernet II作为IEEE802.3的基础这一事实，我们将这两者均看作以太网。</p><p>【实验步骤】</p><p>网络拓扑：BackTrack5--CentOS</p><p>centos<br />用户：root<br />密码：root</p><p>bt5&nbsp;<br />用户：root<br />密码：toor</p><p>第一步：为各主机配置IP地址</p><p>Ubuntu Linux：</p><p>IPA：192.168.1.112/24</p><p>CentOS Linux：</p><p>IPB：192.168.1.100/24</p><p>第二步：从渗透测试主机开启Python解释器</p><p>&nbsp;</p><p>&nbsp;</p><p>第三步：在渗透测试主机Python解释器中导入Scapy库</p><p>&nbsp;</p><p>第四步：查看Scapy库中支持的类</p><p>第五步：在Scapy库支持的类中找到Ethernet类</p><p>第六步：实例化Ethernet类的一个对象，对象的名称为eth</p><p>第七步：查看对象eth的各属性</p><p>第八步：对eth的各属性进行赋值</p><p>第九步：再次查看对象eth的各属性</p><p>&nbsp;</p><p>第十步：启动Wireshark协议分析程序，并设置捕获过滤条件</p><p>&nbsp;</p><p>过滤条件：</p><p>Ether proto 0x0800 and ether src host 11:11:11:11:11:11</p><p>&nbsp;</p><p>第十一步：启动Wireshark</p><p>第十二步：将对象eth通过sendp函数进行发送</p><p>&nbsp;</p><p>第十三步：查看Wireshark捕获的对象eth中的各个属性</p><p>&nbsp;</p><p>实验结束，关闭虚拟机</p>
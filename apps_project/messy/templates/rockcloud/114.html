<p></p><p>Web应用程序文件包含安全攻防</p><p>&nbsp;</p><p><strong>任务环境说明：</strong></p><p>服务器场景：WebServ2003（用户名：administrator；密码：空）</p><p>服务器场景操作系统：Microsoft Windows2003 Server</p><p>服务器场景安装服务/工具1：Apache2.2；</p><p>服务器场景安装服务/工具2：Php6；</p><p>服务器场景安装服务/工具3：Microsoft SqlServer2000；</p><p>服务器场景安装服务/工具4：EditPlus；</p><p>网络拓扑：01-WebServ2003--02-AttWinXp</p><p>windows server 2003<br />用户：administrator<br />密码：空</p><p>1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 访问WebServ2003服务器场景，&quot;/&quot;-&gt;&quot; Display Uploaded&#39;s File Content&quot;，分析该页面源程序，找到提交的变量名，并将该变量名作为Flag（形式：name=&ldquo;变量名&rdquo;）提交；</p><p>查看server2003的ip地址</p><p>可以使用万能用户、任意密码登录</p><p>&#39; union select * from users--</p><p>点击</p><p>&nbsp;</p><p>Flag：name=&quot;filename&quot;</p><p>&nbsp;</p><p>&nbsp;</p><p>2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 对该任务题目1页面注入点进行渗透测试，通过php://filter协议使当前页面以Base64编码方式回显WebServ2003服务器场景访问日志文件：AppServ/Apache2.2/logs/flag.log的内容，并将注入语句作为Flag提交；</p><p>&nbsp;</p><p>&nbsp;</p><p>Flag：php://filter/read=convert.base64-encode/resource=../Apache2.2/logs/flag.log</p><p>&nbsp;</p><p>3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 对该任务题目2页面注入点进行注入以后，将当前页面以Base64编码方式回显内容作为Flag提交；</p><p>&nbsp;</p><p>Flag：V2l0aCBncmVhdCBwb3dlciBjb21lcyBncmVhdCByZXNwb25zaWJpbGl0eS4=</p><p>&nbsp;</p><p>4.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 通过PHP函数对题目3中Base64编码回显内容进行解码，并将解码内容作为Flag提交；</p><p>&nbsp;</p><p>输入php://filter/read=convert-encode/resource=../Apache2.2/logs/flag.log</p><p>Flag：With great power comes great responsibility.</p><p>&nbsp;</p><p>5.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 进入WebServ2003服务器场景的目录，找到DisplayFileCtrl.php文件，使用EditPlus工具打开并填写该文件中空缺的F1、F2、F3、F4的值，使之可以抵御文件包含渗透测试，并提交Flag（形式：F1|F2|F3|F4）；</p><p>&nbsp;</p><p>首先注释下面这段代码</p><p>修改上面这段</p><p>F1：..</p><p>F2：strstr</p><p>F3：empty</p><p>F4：@readfile</p><p>&nbsp;</p><p>6.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 再次对该任务题目1页面注入点进行渗透测试，验证此次利用该注入点对WebServ2003服务器场景进行文件包含渗透测试无效，并将回显页面源文件内容作为Flag提交；</p><p>&nbsp;</p><p>再次进行渗透</p><p>查看源文件</p><p>Flag：Illegal input!&lt;/br&gt;&lt;a href=&#39;DisplayFile.php&#39;&gt;Display Uploaded&#39;s File Content&lt;/a&gt;&lt;/br&gt;</p><p>&nbsp;</p>
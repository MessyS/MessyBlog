<p></p><p>【教学资源类别】</p><table border="1" cellspacing="0" style="width:0px">	<tbody>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p><strong>序号</strong></p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p><strong>类别</strong></p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p><strong>打勾&radic;</strong></p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p>1</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>学习资源</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p><strong>&radic;</strong></p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p>2</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>单兵模式赛题资源</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p>3</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>分组对抗赛题资源</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>&nbsp;</p>			</td>		</tr>	</tbody></table><p>&nbsp;【教学资源名称】&nbsp;</p><p>渗透测试常用工具-使用arpspoof进行arp欺骗</p><p>&nbsp;【教学资源分类】</p><table border="1" cellspacing="0" style="width:0px">	<tbody>		<tr>			<td style="height:14.0pt; width:106.95pt">			<p><strong>一级大类</strong></p>			</td>			<td style="height:14.0pt; width:237.7pt">			<p><strong>二级大类</strong></p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p><strong>打勾&radic;</strong></p>			</td>		</tr>		<tr>			<td rowspan="5" style="height:14.0pt; width:106.95pt">			<p>1.安全标准</p>			</td>			<td style="height:14.0pt; width:237.7pt">			<p>法律法规</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>行业标准</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>安全意识</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>应急响应</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>安全评估</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td rowspan="2" style="height:14.0pt; width:106.95pt">			<p>2.系统安全</p>			</td>			<td style="height:14.0pt; width:237.7pt">			<p>Windows操作系统安全配置</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>Linux操作系统安全配置</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td rowspan="2" style="height:14.0pt; width:106.95pt">			<p>3.网络安全</p>			</td>			<td style="height:14.0pt; width:237.7pt">			<p>网络设备安全</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>网络协议分析</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td rowspan="7" style="height:14.0pt; width:106.95pt">			<p>4.应用安全</p>			</td>			<td style="height:14.0pt; width:237.7pt">			<p>Web应用安全</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>数据库安全</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:18.35pt; width:237.7pt">			<p>中间件应用安全</p>			</td>			<td style="height:18.35pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>应用层协议分析</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p><strong>&radic;</strong></p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>移动应用安全</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>VPN应用</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>恶意代码分析</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td rowspan="2" style="height:14.0pt; width:106.95pt">			<p>5.密码学</p>			</td>			<td style="height:14.0pt; width:237.7pt">			<p>密码学原理</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>密码学应用</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td rowspan="3" style="height:14.0pt; width:106.95pt">			<p>6.渗透测试</p>			</td>			<td style="height:14.0pt; width:237.7pt">			<p>常用工具</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p><strong>&radic;</strong></p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>脚本编写</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>报告编写</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>	</tbody></table><p>【难度说明】</p><table border="1" cellspacing="0" style="width:0px">	<tbody>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p><strong>序号</strong></p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p><strong>难度等级</strong></p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p><strong>打勾&radic;</strong></p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p>1</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>简单</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p><strong>&radic;</strong></p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p>2</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>一般</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p>3</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>困难</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p>4</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>极难</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>&nbsp;</p>			</td>		</tr>	</tbody></table><p>【背景描述】</p><p>某黑客进入了一家公司内部办公网络局域网，然后他开始对其员工电脑进行攻击，希望以此来获得一些账户、密码、以及机密资料。</p><p>【实训设备】</p><table border="1" cellspacing="0" style="width:0px">	<tbody>		<tr>			<td style="vertical-align:top; width:120.5pt">			<p>产品型号</p>			</td>			<td style="vertical-align:top; width:192.4pt">			<p>产品描述</p>			</td>			<td style="vertical-align:top; width:69.8pt">			<p>数量</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:120.5pt">			<p>PY-P8</p>			</td>			<td style="vertical-align:top; width:192.4pt">			<p>实训室安全、应用环境实训平台</p>			</td>			<td style="vertical-align:top; width:69.8pt">			<p>1</p>			</td>		</tr>	</tbody></table><p>【预备知识】</p><p>首先科普一下，arp欺骗的原理，我们的局域网是通过mac地址来进行传输的，路由器有IP对应mac的mac表，我们本地也有arp缓存表，当路由器不知道某个ip对应的mac地址时arp协议就派上了用场。</p><p>看似无懈可击，本地和网关的mac表都记录了对方的mac，但arp协议是基于&ldquo;传闻&rdquo;的协议，别人说什么就信什么，这就为攻击者提供了可乘之机，攻击者对网关说：我就是XXX，又对被攻击者XXX说：我就是网关。这就形成了一个双向欺骗的机制，这句话会被被攻击者和网关缓存在自己的mac表里，导致传输流量都会流经攻击者，此时如果攻击者进行转发流量（把来自于网关发向被攻击者，以及被攻击者发向网关的流量进行转发），并本地抓包，被攻击者与网关通信流量数据将会被攻击者所掌控。</p><p>arpspoof功能及原理分析：arpspoof将局域网内的目标主机或者是所有主机的发送数据包通过ARP欺骗来重指向，在使用交换机的局域网环境下是一个非常有效的方法来嗅探数据。</p><p>arpspoof的基本使用方法：</p><p>arpspoof [-i interface] [-t target] host</p><p>-i 用来指示要使用的网卡接口，一般是eth0,</p><p>-t 用来指示要欺骗的目标主机，如果不表明则默认为局域网内部的所有主机</p><p>host 你要截取数据包的主机，通常是网关</p><p>【实验步骤】</p><p>&nbsp;&nbsp;网络拓扑：bt5--01-server2003</p><p>&nbsp; bt5&nbsp;<br />&nbsp; 用户：root<br />&nbsp; 密码：toor</p><p>&nbsp; windows server 2003<br />&nbsp; 用户：administrator<br />&nbsp; 密码：123456</p><p><strong>【第一步】点击启动选项，启动实验虚拟机。</strong></p><p><strong>【第二步】获取操作机和靶机的IP</strong></p><p>操作机：ifconfig</p><p>靶机：ipconfig</p><p>【<strong>使用到的命令</strong>】</p><p>BT5：</p><p>【命令】通过ifconfig命令获取。</p><p>【解释】Linux中ifconfig是用于显示或配置网络设备（网络接口卡）的命令。</p><p>Windows Server 2003：</p><p>【命令】：ipconfig</p><p>【解释】：通过ipconfig命令获取，Windows中ipconfig用于显示当前的TCP/IP配置的设置值。</p><p><strong>【第三步】在本地开启IP转发，否则很容易被发觉。</strong></p><p>&nbsp; 为使受害者主机的数据包能够顺利收发，我们需在Linux BT5中开启IP转发功能:</p><p>&nbsp; 【截图说明】</p><p>&nbsp;&nbsp; 利用Linux主机的路由功能</p><p>&nbsp;&nbsp; ip_forword状态为1时为打开状态，为0时为关闭状态。所以首先将&ldquo;1&rdquo;写入ip_forword,</p><p>&nbsp;&nbsp; 然后查看其文本状态。</p><p>&nbsp;&nbsp; linux上开启IP_forward命令: echo 1 &gt;&gt; /proc/sys/net/ipv4/ip_forward</p><p>&nbsp;&nbsp; 注意：当机器网络重新启动，这个数字会恢复default＝0，要修改的话，可以修改</p><p>&nbsp;&nbsp; /etc/sysctl.conf文件，永久生效。</p><p>&nbsp; 【<strong>使用到的命令</strong>】</p><p>&nbsp; &nbsp;【命令】echo 1 &gt;&gt; /proc/sys/net/ipv4/ip_forward</p><p>&nbsp;&nbsp; 【解释】echo 在linux中通常用来表示输出一个字符串，但是此处用来将字符串写入某</p><p>&nbsp;&nbsp;&nbsp; 个文件中，后面跟&gt;&gt;的固定格式，最后跟文件的路径以及文件名</p><p>&nbsp;&nbsp; 【命令】cat /proc/sys/net/ipv4/ip_forward</p><p>&nbsp;&nbsp; 【解释】linux中cat命令用来显示某个文件的内容，此处命令用来显示</p><p>&nbsp;&nbsp;&nbsp; /proc/sys/net/ipv4/目录下ip_forward文件的内容，如果显示1，表名上条命令成功</p><p>&nbsp;&nbsp;&nbsp; 地将1写入ip_forword文件。</p><p>&nbsp;</p><p><strong>【第四步】用man arpspoof查看arpspoof参数详细说明</strong></p><p>&nbsp;</p><p>&nbsp;</p><p>【截图说明】arpspoof的主要功能参数如下</p><p>【命令】arpspoof [-i interface] [-t target] host</p><p>【解释】</p><p>-i 用来指示要使用的网卡接口，一般是eth0,</p><p>-t 用来指示要欺骗的目标主机，如果不表明则默认为局域网内部的所有主机</p><p>host 你要截取数据包的主机，通常是网关</p><p>&nbsp;</p><p>【<strong>使用到的命令</strong>】</p><p>【命令】man arpspoof：</p><p>【解释】man命令是Linux下的帮助指令，通过man指令可以查看Linux中的指令帮助、配置文件帮助和编程帮助等信息。</p><p>【命令】q</p><p>【解释】退出arpspoof工具的帮助信息</p><p>&nbsp;</p><p><strong>【第五步】查看win2003中所返回的网关的mac地址</strong></p><p>&nbsp;</p><p>【<strong>使用到的命令</strong>】</p><p>【命令】arp &ndash;a</p><p>【解释】显示ARP缓存，显示电脑上所有的ARP缓存条目；</p><p>&nbsp;</p><p><strong>【第六步】下面的命令是利用ARP毒化，重定向受害者的流量传送给攻击者。</strong></p><p>&nbsp;</p><p>&nbsp;</p><p>【<strong>使用到的命令</strong>】</p><p>【命令】arpspoof -i eth0 -t 192.168.134.163 192.168.134.2</p><p>【解释】</p><p>arpspoof [-i interface] [-t target] host</p><p>-i 用来指示要使用的网卡接口，一般是eth0,</p><p>-t 用来指示要欺骗的目标主机，如果不表明则默认为局域网内部的所有主机</p><p>host 你要截取数据包的主机，通常是网关</p><p>&nbsp;</p><p><strong>【第七步】现在做第二个ARP毒化攻击，使网关的数据重定向到攻击者的机器。（流量由网关到攻击者再到受攻击者）。</strong></p><p>&nbsp;</p><p>&nbsp;</p><p>【<strong>使用到的命令</strong>】</p><p>【命令】arpspoof -i eth0 -t 192.168.134.2 192.168.134.162</p><p>【解释】ARP毒化攻击，使网关的数据重定向到攻击者的机器。</p><p>&nbsp;</p><p><strong>【第八步】查看结果，发现我们的arp缓存列表网关mac变成了我们BT5的MAC，至此我们已经获得了192.168.134.163的流量</strong></p><p>【截图说明】</p><p>网关的MAC地址变成了BT5的MAC地址，实验成功。</p><p>【<strong>使用到的命令</strong>】</p><p>【命令】arp &ndash;a</p><p>【解释】查看windows2003的mac地址缓存表</p><p>【命令】ifconfig</p><p>【解释】查看bt5的mac地址，如果Windows2003 arp缓存表中网关的mac地址是bt5的mac就证明被欺骗成功。</p><p>&nbsp;</p><p><strong>【第九步】抓取Win 2003的数据包，分析数据包</strong></p><p><strong>【截图说明】</strong></p><p>1.为了不影响实验结果，首先使用arp &ndash;d命令来清除本地MAC缓存表。</p><p>2.然后使用arp &ndash;a命令查看本地ARP缓存表，确保没有MAC地址存在。</p><p><strong>【使用到的命令】</strong></p><p>【命令】arp &ndash;d</p><p>【解释】清除本地ARP缓存</p><p>【命令】arp &ndash;a</p><p>【解释】显示本地ARP缓存表</p><p>【截图说明】</p><p>在Win 2003上ping 网关（192.168.134.2）</p><p>【截图说明】</p><p>【Type】:ARP 数据包</p><p>【解释】</p><p>在Win 2003上ping 网关（192.168.134.2），因为本地没有ARP缓存存在，所以首先要找</p><p>到192.168.134.2对应的MAC地址。</p><p>第一个数据包：在局域网中寻找192.168.134.2对应的MAC地址，数据包的信息是：谁有</p><p>192.168.134.2的MAC地址，如果有，请告诉192.168.134.163.</p><p>第二个数据包：当192.168.134.2收到这个数据包后，发现是一个寻找自己MAC地址的数据</p><p>包，于是告诉192.168.134.163，我（网关192.168.134.2）的MAC地址是：00:0c:29:f7:a6:75.</p><p>事实上，00:0c:29:f7:a6:75是BT5的MAC地址，所以实验成功。</p><p>&nbsp;</p><p>实验结束，关闭虚拟机。</p>
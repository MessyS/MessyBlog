<p></p><p>【教学资源类别】</p><table border="1" cellspacing="0" style="width:0px">	<tbody>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p><strong>序号</strong></p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p><strong>类别</strong></p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p><strong>打勾&radic;</strong></p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p>1</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>学习资源</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>&radic;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p>2</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>单兵模式赛题资源</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p>3</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>分组对抗赛题资源</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>&nbsp;</p>			</td>		</tr>	</tbody></table><p>&nbsp;【教学资源名称】&nbsp;</p><p>渗透测试常用工具-使用wireshark进行网络嗅探</p><p>&nbsp;【教学资源分类】</p><table border="1" cellspacing="0" style="width:0px">	<tbody>		<tr>			<td style="height:14.0pt; width:106.95pt">			<p>一级大类</p>			</td>			<td style="height:14.0pt; width:237.7pt">			<p>二级大类</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>打勾&radic;</p>			</td>		</tr>		<tr>			<td rowspan="5" style="height:14.0pt; width:106.95pt">			<p>1.安全标准</p>			</td>			<td style="height:14.0pt; width:237.7pt">			<p>法律法规</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>行业标准</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>安全意识</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>应急响应</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>安全评估</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td rowspan="2" style="height:14.0pt; width:106.95pt">			<p>2.系统安全</p>			</td>			<td style="height:14.0pt; width:237.7pt">			<p>Windows操作系统安全配置</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>Linux操作系统安全配置</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td rowspan="2" style="height:14.0pt; width:106.95pt">			<p>3.网络安全</p>			</td>			<td style="height:14.0pt; width:237.7pt">			<p>网络设备安全</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>网络协议分析</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td rowspan="7" style="height:14.0pt; width:106.95pt">			<p>4.应用安全</p>			</td>			<td style="height:14.0pt; width:237.7pt">			<p>Web应用安全</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>数据库安全</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>中间件应用安全</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>应用层协议分析</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&radic;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>移动应用安全</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>VPN应用</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>恶意代码分析</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td rowspan="2" style="height:14.0pt; width:106.95pt">			<p>5.密码学</p>			</td>			<td style="height:14.0pt; width:237.7pt">			<p>密码学原理</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>密码学应用</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td rowspan="3" style="height:14.0pt; width:106.95pt">			<p>6.渗透测试</p>			</td>			<td style="height:14.0pt; width:237.7pt">			<p>常用工具</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p><strong>&radic;</strong></p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>脚本编写</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>报告编写</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>	</tbody></table><p>【难度说明】</p><table border="1" cellspacing="0" style="width:0px">	<tbody>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p>序号</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>难度等级</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>打勾&radic;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p>1</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>简单</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>&radic;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p>2</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>一般</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p>3</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>困难</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p>4</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>极难</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>&nbsp;</p>			</td>		</tr>	</tbody></table><p>【背景描述】</p><p>XX企业，为加强信息化建设，组建了企业内部网络，用于自身网站的建设，小峰是该企业新进网管，承担网络的管理工作。 现该企业网络存在如下需求： <strong>查看自己的电脑流量走向哪里</strong></p><p>&nbsp;【实训设备】</p><table border="1" cellspacing="0" style="width:0px">	<tbody>		<tr>			<td style="height:14.35pt; vertical-align:top; width:146.65pt">			<p>产品型号</p>			</td>			<td style="height:14.35pt; vertical-align:top; width:180.8pt">			<p>产品描述</p>			</td>			<td style="height:14.35pt; vertical-align:top; width:2.0cm">			<p>数量</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:146.65pt">			<p>PY-P8</p>			</td>			<td style="vertical-align:top; width:180.8pt">			<p>实训室安全、应用环境实训平台</p>			</td>			<td style="vertical-align:top; width:2.0cm">			<p>1</p>			</td>		</tr>	</tbody></table><p><strong>【预备知识】</strong></p><p>一、Wireshark（前称Ethereal）是一个网络封包分析软件。网络封包分析软件的功能是撷取网络封包，并尽可能显示出最为详细的网络封包资料。Wireshark使用WinPCAP作为接口，直接与网卡进行数据报文交换</p><p>二、网络封包分析软件的功能可想像成 &quot;电工技师使用电表来量测电流、电压、电阻&quot; 的工作 - 只是将场景移植到网络上，并将电线替换成网络线。在过去，网络封包分析软件是非常昂贵的，或是专门属于盈利用的软件。Ethereal的出现改变了这一切。在GNUGPL通用许可证的保障范围底下，使用者可以以免费的代价取得软件与其源代码，并拥有针对其源代码修改及客制化的权利。Ethereal是目前全世界最广泛的网络封包分析软件之一。</p><p><strong>【工具原理】</strong></p><p>　&nbsp;&nbsp; 以太网数据是以广播方式发送的，意即局域网内的每台主机都在监听网内传输的数据。以太网硬件将监听到的数据帧所包含的MAC地址与自己的MAC地址比较，如果相同，则接受该帧，否则忽略他，这个是以太网的过滤规则。但是，如果把以太网的硬件设置为&ldquo;混杂模式&rdquo;，那么它就可以接收网内的所有数据帧。WinPcap相当于是一个库为抓包工具提供相关的支持。嗅探器就是依据这种原理来监测网络中流动着的数据</p><p>【实验步骤】</p><p>&nbsp;&nbsp;网络拓扑：bt5--01-server2003</p><p>&nbsp; bt5&nbsp;<br />&nbsp; 用户：root<br />&nbsp; 密码：toor</p><p>&nbsp; windows server 2003<br />&nbsp; 用户：administrator<br />&nbsp; 密码：123456</p><p><strong>【第一步】点击启动选项，启动实验虚拟机。</strong></p><p><strong>【第二步】获取靶机和操作机的IP</strong></p><p>操作机：<strong>ifconfig</strong></p><p>&nbsp;</p><p><strong>【第三步】在靶机开启web服务</strong></p><p>我们在靶机开启web服务的目地，是为了第四步更好的对流量进行分析</p><p>1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 在桌面打开phpStudy</p><p>phpstudy是一个PHP调试环境的程序及承包，改程序包集成最新的Apache+PHP+MySQL+phpmyadmin+ZendOptimizer,一次性安装，无需配置即可使用，是非常方便，好用的PHP调试环境，该程序不仅包括PHP调试环境，还开发环境，开发手册等。</p><p>&nbsp;</p><p>2.&nbsp;&nbsp; 打开phpStudy后，点击启动按钮即可</p><p>&nbsp;</p><p>3.&nbsp;&nbsp; 在浏览器输入 <a href="http://localhost">http://localhost</a> 即可看到web服务已经正常启动</p><p>&nbsp;</p><p>&nbsp;</p><p>4.&nbsp;&nbsp; 获取靶机IP在cmd窗口内输入命令：ipconfig</p><p><strong>【第四步】在BT5内使用wireshark使用</strong></p><p>打开wireshark,在终端内使用命令wireshark, 输入之后敲入回车键就能打wireshark</p><p>下图为wireshark主界面</p><p>&nbsp;&nbsp; <img src="api/attachment?type=courseDocument&amp;id=1363" style="height:397px; width:520px" /></p><p><strong>【如何开始抓包】</strong></p><p>首先选择当前计算机当前正在使用的网卡，然后直接点击左上角进行抓包，如下</p><p>图所示：</p><p>&nbsp;</p><p>点击之后会弹出下图，下图列出了我们的网卡，其中名为eth0的网卡就是我们要抓取</p><p>的，勾选后，点击下面的Start开始抓取流量</p><p>&nbsp;</p><p>点击start后，出现下面页面</p><p>【流量】当前eth0网卡</p><p>&nbsp;</p><p>上图面板每一行对应一个网络报文，默认显示报文接收时间（相对开始抓取的时间点），</p><p>源和目标IP地址，使用协议和报文相关信息</p><p>上图可以看到点击某一行可以在下面两个窗口看到更多信息。&ldquo;+&rdquo;图标显示报文里面每一</p><p>层的详细信息。底端窗口同时以十六进制和ASCII码的方式列出报文内容</p><p>需要停止抓取报文的时候，点击左上角的停止按键</p><p>&nbsp;</p><p><strong>【色彩标识】</strong></p><p>进行到这里已经看到报文以绿色，蓝色，黑色显示出来。Wireshark通过颜色让各种流</p><p>量的报文一目了然。</p><p>&nbsp;</p><p><strong>绿色：TCP</strong><strong>报文</strong></p><p>&nbsp;</p><p><strong>深蓝色：DNS</strong></p><p>&nbsp;</p><p><strong>浅蓝：UDP</strong></p><p><strong>&nbsp;</strong></p><p><strong>黑色：标识出有问题的TCP</strong><strong>报文</strong>&mdash;&mdash;比如乱序报文</p><p><strong>【如何标记】</strong></p><p>有时为了分析方便且看起来更加直观可以根据需要进行标记要标记的流量</p><p>右键选择Mark Packet(toggle)即可标记</p><p>标记后可以看到已经变成了黑色，如下图：</p><p>&nbsp;</p><p><strong>【如何取消标记】</strong></p><p>和标记步骤一样，右键点击<strong>Mark Packet(toggle)</strong>即可</p><p>&nbsp;</p><p><strong>【选项功能】</strong></p><p>依次选择Edit&mdash;&gt;Preferences</p><p>备注：【Edit】编辑修改、【Preference】属性设置</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p><p>打开后，按照下图选择左侧capture，就可以看到右侧的内容</p><p>右侧可以勾选的5个内容意思是：</p><p>1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 使用混杂模式捕获分组</p><p>2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 使用pcap-ng格式捕获分组</p><p>3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 实时更新分组列表</p><p>4.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 实时捕获时自动滚屏</p><p>5.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 捕获时显示捕获汇总对话框</p><p>上方Default interface 为选取所抓取流量的网卡框</p><p>我们可以根据自己的需求勾选</p><p>&nbsp;</p><p><strong>【布局设置】</strong></p><p>左侧：User interface&mdash;Layout</p><p>&nbsp;</p><p><strong>【检查报文】</strong></p><p>选中一个报文之后，就可以深入挖掘它的内容了</p><p>也可以在这里创建过滤条件&mdash;&mdash;只需右键细节并使用<strong>Apply as Filter</strong>子菜单，就可以根</p><p>据此细节创建过滤条件。如下图所示：</p><p>&nbsp;</p><p><strong>【基本信息统计工具的用法】</strong></p><p>Wireshark一个强大的功能在于它的统计工具。使用Wireshark的时候，我们有各种类型的工具可供选择，从简单的如显示终端节点和会话到复杂的如Flow和IO图表。本文将介绍基本网络统计工具。包括：捕捉文件摘要,捕捉包的层次结构, 会话, 终端节点, HTTP。</p><p>单击Statistics菜单，即可看到所有关于统计信息的菜单。如下图所示：</p><p>【statistics】统计</p><p>【统计摘要信息】</p><p>【下拉选项】:sunmmary</p><p>【例如】：单击Statistics菜单，选择Summary选项即可查看统计摘要信息，可以通过</p><p>这些统计信息了解到以下内容：数据包的名称，数据包大小，抓的开始时间及结束时</p><p>间，抓包所使用的操作系统，抓包的速率等信息</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p><strong>【过滤规则】</strong></p><p>使用Wireshark时最常见的问题，是当您使用默认设置时，会得到大量冗余信息，以至于很难找到自己需要的部分。这时就需要使用网络数据过滤器，Wireshark过滤器总共分两类：</p><p>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;【捕捉过滤器（CaptureFilters）】：用于决定将什么样的信息记录在捕捉结果中。</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 需要在开始捕捉前设置。</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;【显示过滤器（DisplayFilters）】：在捕捉结果中进行详细查找。他们可以在得到</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 捕捉结果后随意修改。</p><p>根据使用的不同目的，我们在网络数据抓包过程中应灵活选择使用过滤器：</p><p>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 【第一种】捕捉过滤器是数据经过的第一层过滤器，它用于控制捕捉数据的数</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;量，以避免产生过大的日志文件。</p><p>&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 【第二种】显示过滤器是一种更为强大（复杂）的过滤器。它允许您在日志文</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;件中迅速准确地找到所需要的记录。</p><p>&nbsp;&nbsp;&nbsp; 【例如】</p><p>tcp dst port 3128</p><p>显示目的TCP端口为3128的封包。</p><p>ip src host 10.1.1.1</p><p>显示来源IP地址为10.1.1.1的封包。</p><p>host 10.1.2.3</p><p>显示目的或来源IP地址为10.1.2.3的封包。</p><p>src portrange 2000-2500</p><p>显示来源为UDP或TCP，并且端口号在2000至2500范围内的封包。</p><p>not imcp</p><p>显示除了icmp以外的所有封包。（icmp通常被ping工具使用）</p><p>src host 10.7.2.12 and not dst net 10.200.0.0/16</p><p>显示来源IP地址为10.7.2.12，但目的地不是10.200.0.0/16的封包。</p><p>&nbsp;</p><p>snmp || dns || icmp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p><p>显示SNMP或DNS或ICMP封包。</p><p>ip.addr == 10.1.1.1</p><p>显示来源或目的IP地址为10.1.1.1的封包。</p><p>ip.src != 10.1.2.3 or ip.dst != 10.4.5.6</p><p>显示来源不为10.1.2.3或者目的不为10.4.5.6的封包。</p><p>换句话说，显示的封包将会为：</p><p>来源IP：除了10.1.2.3以外任意；目的IP：任意</p><p>tcp.port == 25 显示来源或目的TCP端口号为25的封包。</p><p>tcp.dstport == 25&nbsp;&nbsp;&nbsp;&nbsp; 显示目的TCP端口号为25的封包。</p><p>tcp.flags&nbsp;&nbsp; 显示包含TCP标志的封包。</p><p>tcp.flags.syn == 0x02&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 显示包含TCP SYN标志的封包。</p><p>&nbsp;</p><p><strong>【过滤报文】</strong></p><p>如果正在尝试分析问题，比如打电话的时候某一程序发送的报文，可以关闭所有其他</p><p>使用网络的应用来减少流量。但还是可能有大批报文需要筛选，这时要用Wireshark</p><p>过滤器。</p><p>最基本的方式就是在窗口顶端过滤栏输入并点击Apply（或按下回车）。例如，输入</p><p>&ldquo;dns&rdquo;就会只看到DNS报文。输入的时候，Wireshark会帮助自动完成过滤条件</p><p>&nbsp;<img src="api/attachment?type=courseDocument&amp;id=1346" style="height:353px; width:511px" /></p><p>&nbsp;</p><p>也可以点击<strong>Analyze</strong>菜单并选择<strong>Display Filters</strong>来创建新的过滤条件</p><p>下图是打开后的页面</p><p>通过过滤，我们能更容易的找到想找的报文</p><p>&nbsp;</p><p>另一件很有趣的事情是你可以右键报文并选择<strong>Follow TCP Stream</strong></p><p>你会看到在服务器和客户端请求响应的全部会话报文。</p><p>到这里wireshark实验文档结束了</p><p>&nbsp;</p><p>实验结束，关闭虚拟机。</p>
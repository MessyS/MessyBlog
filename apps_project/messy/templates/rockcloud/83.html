<p></p><p>【教学资源类别】</p><table border="1" cellspacing="0" style="width:100.0%">	<tbody>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>序号</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>类别</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>打勾&radic;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>1</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>学习资源</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&radic;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>2</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>单兵模式赛题资源</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>3</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>分组对抗赛题资源</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&nbsp;</p>			</td>		</tr>	</tbody></table><p>&nbsp;【教学资源名称】&nbsp;</p><p>&nbsp; 应用层协议分析-通过Windows2003网络服务搭建DNS协议分析</p><p>&nbsp;【教学资源分类】</p><table border="1" cellspacing="0" style="width:100.0%">	<tbody>		<tr>			<td style="height:14.0pt; width:25.1%">			<p>一级大类</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>二级大类</p>			</td>			<td style="height:14.0pt; width:19.12%">			<p>打勾&radic;</p>			</td>		</tr>		<tr>			<td rowspan="5" style="height:14.0pt; width:25.1%">			<p>1.安全标准</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>法律法规</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>行业标准</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>安全意识</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>应急响应</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>安全评估</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td rowspan="2" style="height:14.0pt; width:25.1%">			<p>2.系统安全</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>Windows操作系统安全配置</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>Linux操作系统安全配置</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td rowspan="2" style="height:14.0pt; width:25.1%">			<p>3.网络安全</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>网络设备安全</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>网络协议分析</p>			</td>			<td style="height:14.0pt; width:19.12%">			<p>&radic;</p>			</td>		</tr>		<tr>			<td rowspan="7" style="height:14.0pt; width:25.1%">			<p>4.应用安全</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>Web应用安全</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>数据库安全</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>中间件应用安全</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>应用层协议分析</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>移动应用安全</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>VPN应用</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>恶意代码分析</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td rowspan="2" style="height:14.0pt; width:25.1%">			<p>5.密码学</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>密码学原理</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>密码学应用</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td rowspan="3" style="height:14.0pt; width:25.1%">			<p>6.渗透测试</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>常用工具</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>脚本编写</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>报告编写</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>	</tbody></table><p>【难度说明】</p><table border="1" cellspacing="0" style="width:100.0%">	<tbody>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>序号</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>难度等级</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>打勾&radic;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>1</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>简单</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&radic;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>2</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>一般</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>3</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>困难</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>4</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>极难</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&nbsp;</p>			</td>		</tr>	</tbody></table><p>【背景描述】</p><p>XX企业，为加强信息化建设，组建了企业内部网络，用于自身网站的建设，小王是该企业新进网管，承担网络的管理工作。</p><p>现该企业网络存在如下需求：</p><p>通过企业网络NIDS分析，经常发现网络中出现针对DNS服务的DOS攻击，造成DNS服务器宕机，针对此问题，需要提出针对此攻击的解决方案，再次之前，需要首先对DNS协议的工作原理进行研究。</p><p>&nbsp;【实训设备】</p><table border="1" cellspacing="0">	<tbody>		<tr>			<td style="vertical-align:top; width:4.0cm">			<p>产品型号</p>			</td>			<td style="vertical-align:top; width:199.5pt">			<p>产品描述</p>			</td>			<td style="vertical-align:top; width:69.8pt">			<p>数量</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:4.0cm">			<p>PY-P8</p>			</td>			<td style="vertical-align:top; width:199.5pt">			<p>实训室安全、应用环境实训平台</p>			</td>			<td style="vertical-align:top; width:69.8pt">			<p>1</p>			</td>		</tr>	</tbody></table><p>【预备知识】&nbsp;</p><p>DNS基本概念</p><p>DNS（Domain NameSystem，域名系统），因特网上作为域名和IP地址相互映射的一个分布式数据库，能够使用户更方便的访问互联网，而不用去记住能够被机器直接读取的IP数串。通过主机名，最终得到该主机名对应的IP地址的过程叫做域名解析（或主机名解析）。</p><p>DNS协议流程</p><p>DNS协议运行在TCP协议或者UDP协议之上，使用端口号53。DNS在进行区域传输的时候使用TCP协议（区域传送指的是一台备用服务器使用来自主服务器的数据同步自己的域数据库），其它时候则使用UDP协议。</p><p>查询过程：客户向DNS服务器的53端口发送UDP/TCP报文，DNS服务器收到后进行处理，并把结果记录仍以UDP/TCP报文的形式返回过来。</p><p>这里我们主要讨论使用UDP报文进行DNS查询的流程。</p><p>DNS协议格式</p><p>ID：2字节，标识符，通过随机数标识该请求。</p><p>Flags：2字节，标志位设置。</p><p>第1位：msg类型，0为请求（query）1为响应（response）。</p><p>第2-5位：opcode，查询种类，0000表示标准query。</p><p>第6位：是否权威应答 （应答时才有意义）。</p><p>第7位：因为一个UDP报文为512字节，所以该位指示是否截断超过的部分。</p><p>第8位：是否请求递归（这个比特位被请求设置，应答的时候使用的相同值返回）。</p><p>第9位：由DNS回复返回指定，说明DNS服务器是否支持递归查询（这个比特位在应答中设置或取消）。</p><p>第10-12位：保留位（设置为0）。</p><p>第13-16位：应答码（0：没有错误，1：格式错误，2：服务器错误，3：名字错误，4：服务器不支持，5：拒绝，6-15：保留值）。</p><p>Questions：2字节，报文请求段中的问题记录数；</p><p>AnswerRRs：2字节，报文回答段中的回答记录数；</p><p>AuthorityRRs：2字节，报文授权段中的授权记录数；</p><p>AdditionalRRs：2字节，报文附加段中的附加记录数；</p><p>Queries：查询请求内容（响应时不变即可）。</p><p>Name：不定长，域名（例子：www.baidu.com需写作：3www5baidu3com0）。</p><p>Type：2字节查询的资源记录类型。</p><p>Class：2字节指定信息的协议组。</p><p>Answers：查询响应内容，可以有0-n条（请求时为空即可）。</p><p>Name：2字节（压缩编码）指向name第一次出现的地址且前两个bit为11。</p><p>Type：2字节响应类型。</p><p>Class：2字节。</p><p>TTL：4字节。</p><p>Datalength：2字节，指接下来的data长度，单位为字节。</p><p>Address/CNAME：4字节地址/不定长域名。</p><p>&nbsp;&nbsp;&nbsp; Authoritativenameservers：</p><p>Name：2字节（压缩编码）指向name第一次出现的地址且前两个bit为11。</p><p>Type：2字节响应类型。此处为2（NS）。</p><p>Class：2字节。</p><p>TTL：4字节。</p><p>Datalength：2字节，指接下来的data长度，单位为字节。</p><p>nameserver：此处为6字节，表示的，表示方法待研究。</p><p>&nbsp;&nbsp;&nbsp; Additionalrecords：</p><p>Name：2字节（压缩编码）指向name第一次出现的地址且前两个bit为11。</p><p>Type：2字节响应类型。</p><p>Class：2字节，表示类型。</p><p>TTL：4字节。</p><p>Datalength：2字节，指接下来的data长度，单位为字节。</p><p>Address：此处为4字节地址。</p><p>【实验步骤】</p><p>网络拓扑：BackTrack5--Windows2003--Windows2003</p><p>bt5&nbsp;<br />用户：root<br />密码：toor</p><p>windows server 2003<br />用户：administrator<br />密码：空</p><p>第一步：配置服务器和客户机的IP地址</p><p>服务器：192.168.1.112</p><p>客户机：192.168.1.111</p><p>第二步：确保服务器安装了DNS服务：</p><p>第三步：在DNS服务管理器正向查找区域中添加记录www.taojin.com-&gt;192.168.1.112</p><p>&nbsp;</p><p>第四步：在客户机操作系统配置IP：192.168.1.111，并将DNS服务指向IP：192.168.1.112</p><p>&nbsp;</p><p>第五步：在客户机操作系统Shell程序下使用工具nslookup</p><p>第六步：在nslookup程序下，解析域名www.taojin.com</p><p>第七步：进行DNS服务器的IP配置（注意：此处DNS为空；并配置DNS服务器的网关，目的是使DNS服务器能够访问Internet，与Internet上的DNS服务器之间进行递归查询）</p><p>第八步：清空DNS服务器的缓存记录</p><p>第九步：清空客户机的DNS缓存记录</p><p>第十步：进行客户机的IP配置（注意此处网关为空，由于客户机不需要Internet访问，DNS指向192.168.1.112）</p><p>第十一步：打开WireShark程序，并配置过滤条件</p><p>&nbsp;</p><p>第十二步：启动客户机nslookup程序</p><p>&nbsp;</p><p>第十三步：解析域名www.baidu.com</p><p>第十四步：打开WireShark程序，对照预备知识，分析DNS递归查询数据对象</p><p>第十五步：打开WireShark程序，对照预备知识，分析DNS迭代查询过程</p><p>第十六步：解析域名www.taojin.com</p><p>第十七步：打开WireShark程序，对照预备知识，分析DNS递归查询数据对象</p><p>&nbsp;</p><p>&nbsp;</p><p>实验结束，关闭虚拟机。</p>
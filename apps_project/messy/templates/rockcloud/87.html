<p></p><p>【教学资源类别】</p><table border="1" cellspacing="0" style="width:100.0%">	<tbody>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>序号</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>类别</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>打勾&radic;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>1</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>学习资源</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&radic;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>2</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>单兵模式赛题资源</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>3</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>分组对抗赛题资源</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&nbsp;</p>			</td>		</tr>	</tbody></table><p>&nbsp;【教学资源名称】&nbsp;</p><p>&nbsp; VPN安全-通过WireShark进行IKE协议分析</p><p>&nbsp;【教学资源分类】</p><table border="1" cellspacing="0" style="width:100.0%">	<tbody>		<tr>			<td style="height:14.0pt; width:25.1%">			<p>一级大类</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>二级大类</p>			</td>			<td style="height:14.0pt; width:19.12%">			<p>打勾&radic;</p>			</td>		</tr>		<tr>			<td rowspan="5" style="height:14.0pt; width:25.1%">			<p>1.安全标准</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>法律法规</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>行业标准</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>安全意识</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>应急响应</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>安全评估</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td rowspan="2" style="height:14.0pt; width:25.1%">			<p>2.系统安全</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>Windows操作系统安全配置</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>Linux操作系统安全配置</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td rowspan="2" style="height:14.0pt; width:25.1%">			<p>3.网络安全</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>网络设备安全</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>网络协议分析</p>			</td>			<td style="height:14.0pt; width:19.12%">			<p>&radic;</p>			</td>		</tr>		<tr>			<td rowspan="7" style="height:14.0pt; width:25.1%">			<p>4.应用安全</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>Web应用安全</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>数据库安全</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>中间件应用安全</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>应用层协议分析</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>移动应用安全</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>VPN应用</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>恶意代码分析</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td rowspan="2" style="height:14.0pt; width:25.1%">			<p>5.密码学</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>密码学原理</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>密码学应用</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td rowspan="3" style="height:14.0pt; width:25.1%">			<p>6.渗透测试</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>常用工具</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>脚本编写</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>报告编写</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>	</tbody></table><p>【难度说明】</p><table border="1" cellspacing="0" style="width:100.0%">	<tbody>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>序号</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>难度等级</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>打勾&radic;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>1</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>简单</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&radic;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>2</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>一般</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>3</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>困难</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>4</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>极难</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&nbsp;</p>			</td>		</tr>	</tbody></table><p>【背景描述】</p><p>XX企业，为加强信息化建设，组建了企业内部网络，用于自身网站的建设，小王是该企业新进网管，承担网络的管理工作。</p><p>现该企业网络存在如下需求：</p><p>如果在企业网络中采用明文的方式传输数据，容易出现网络监听攻击，造成数据的泄露；针对此问题，需要提出针对此攻击的解决方案，在此之前，需要首先对IPSec的工作原理进行研究。</p><p>【实训设备】</p><table border="1" cellspacing="0">	<tbody>		<tr>			<td style="vertical-align:top; width:4.0cm">			<p>产品型号</p>			</td>			<td style="vertical-align:top; width:199.5pt">			<p>产品描述</p>			</td>			<td style="vertical-align:top; width:69.8pt">			<p>数量</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:4.0cm">			<p>PY-P8</p>			</td>			<td style="vertical-align:top; width:199.5pt">			<p>实训室安全、应用环境实训平台</p>			</td>			<td style="vertical-align:top; width:69.8pt">			<p>1</p>			</td>		</tr>	</tbody></table><p>&nbsp;</p><p>【预备知识】</p><p>&nbsp;&nbsp;&nbsp; IKE（Internet Key Exchange） ，也就是互联网密钥交换协议；</p><p>我们已经熟悉了IPSec框架所提供的主要服务，我们知道了IPSec VPN需要预先协商加密协议，散列函数，封装协议，封装模式和密钥有效期等等内容。实际协商这类内容的协议叫做互联网密钥交换协议IKE。IKE主要完成如下三个方面的任务。</p><p>第一、协商协议参数（加密协议，散列函数，封装协议，封装模式和密钥有效期）；</p><p>第二、通过密钥交换，产生用于加密和HMAC用的随机密钥；</p><p>第三、对建立IPSec的双方进行认证（需要预先协商认证方式）。</p><p>协商完成后的结果就叫做安全关联SA，也可以说IKE建立了安全关联。IKE一共协商了两种类型的SA，一种叫做IKE SA，一种叫做IPSec SA。IKE SA维护了如何安全防护（加密协议，散列函数，认证方式，密钥有效期等等）IKE协议的细节。IPSec SA维护了如何安全防护实际流量的细节。</p><p>IKE由三个协议组成。</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>1. SKEME决定了IKE的密钥交换方式，IKE主要使用DH来实现密钥交换。</p><p>2. Oakley决定了IPSec的框架设计，让IPSec能够支持更多的协议。</p><p>3. ISAKMP是IKE的本质协议，决定了IKE协商包的封装格式，交换过程和模式的切换。</p><p>IKE与ISAKMP</p><p>ISAKMP是IKE的核心协议，所以我们经常会把IKE与ISAKMP互换，例如：IKE SA也经常被说成ISAKMP SA。并且在配置IPSec VPN的时候主要的配置内容也是ISAKMP，SKEME和Oakley没有任何相关配置内容，所以常常会认为IKE和ISAKMP是一样的。如果非要对IKE和ISAKMP做一个区分的话，由于SKEME的存在IKE能够决定密钥交换的方式，但是ISAKMP只能够为密钥交换交换数据包，但却不能决定密钥交换实现的方式。</p><p>IKE的两个阶段与三个模式</p><p>上图是IKE协商示意图，从这幅图我们可以看到IKE协商分为两个不同阶段，第一阶段和第二阶段。分别可以使用六个包交换的主模式或者三个包交换的主动模式来完成第一阶段协商，第一阶段协商的主要目的就是对需要建立IPSec的双方进行认证，确保合法的对等体（peer）才能够建立IPSec VPN。协商得到的结果就是IKE SA。第二阶段总是使用三个包交换的快速模式来完成，第二阶段的主要目的就是根据具体需要加密的流量（感兴趣流），协商保护这些流量的策略。协商的结果就是IPSec SA。</p><p>【实验步骤】</p><p>网络拓扑：BackTrack5--Windows2003--Windows2003</p><p>bt5&nbsp;<br />用户：root<br />密码：toor</p><p>windows server 2003<br />用户：administrator<br />密码：空</p><p>第一步：为服务器和客户机分别配置IP地址，并测试连通性</p><p>&nbsp;</p><p>第二步：验证服务器和客户机之间基于IP安全策略的连通性</p><p>第三步：打开WireShark，并配置过滤条件</p><p>第四步：再次验证服务器和客户机之间基于IP安全策略的连通性</p><p>第五步：打开WireShark，对照预备知识，对IKE的工作过程进行分析</p><p>&nbsp;</p><p>&nbsp;</p><p>实验结束，关闭虚拟机。</p>
<p></p><p>【教学资源类别】</p><table border="1" cellspacing="0" style="width:0px">	<tbody>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p><strong>序号</strong></p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p><strong>类别</strong></p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p><strong>打勾&radic;</strong></p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p>1</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>学习资源</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p><strong>&radic;</strong></p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p>2</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>单兵模式赛题资源</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p>3</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>分组对抗赛题资源</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>&nbsp;</p>			</td>		</tr>	</tbody></table><p>&nbsp;【教学资源名称】&nbsp;</p><p>渗透测试常用工具-使用stunnel内网穿透</p><p>&nbsp;【教学资源分类】</p><table border="1" cellspacing="0" style="width:0px">	<tbody>		<tr>			<td style="height:14.0pt; width:106.95pt">			<p><strong>一级大类</strong></p>			</td>			<td style="height:14.0pt; width:237.7pt">			<p><strong>二级大类</strong></p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p><strong>打勾&radic;</strong></p>			</td>		</tr>		<tr>			<td rowspan="5" style="height:14.0pt; width:106.95pt">			<p>1.安全标准</p>			</td>			<td style="height:14.0pt; width:237.7pt">			<p>法律法规</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>行业标准</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>安全意识</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>应急响应</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>安全评估</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td rowspan="2" style="height:14.0pt; width:106.95pt">			<p>2.系统安全</p>			</td>			<td style="height:14.0pt; width:237.7pt">			<p>Windows操作系统安全配置</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>Linux操作系统安全配置</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td rowspan="2" style="height:14.0pt; width:106.95pt">			<p>3.网络安全</p>			</td>			<td style="height:14.0pt; width:237.7pt">			<p>网络设备安全</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>网络协议分析</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td rowspan="7" style="height:14.0pt; width:106.95pt">			<p>4.应用安全</p>			</td>			<td style="height:14.0pt; width:237.7pt">			<p>Web应用安全</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>数据库安全</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>中间件应用安全</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>应用层协议分析</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p><strong>&radic;</strong></p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>移动应用安全</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>VPN应用</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>恶意代码分析</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td rowspan="2" style="height:14.0pt; width:106.95pt">			<p>5.密码学</p>			</td>			<td style="height:14.0pt; width:237.7pt">			<p>密码学原理</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>密码学应用</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td rowspan="3" style="height:14.0pt; width:106.95pt">			<p>6.渗透测试</p>			</td>			<td style="height:14.0pt; width:237.7pt">			<p>常用工具</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p><strong>&radic;</strong></p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>脚本编写</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="height:14.0pt; width:237.7pt">			<p>报告编写</p>			</td>			<td style="height:14.0pt; width:81.45pt">			<p>&nbsp;</p>			</td>		</tr>	</tbody></table><p>【难度说明】</p><table border="1" cellspacing="0" style="width:0px">	<tbody>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p><strong>序号</strong></p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p><strong>难度等级</strong></p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p><strong>打勾&radic;</strong></p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p>1</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>简单</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p><strong>&radic;</strong></p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p>2</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>一般</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p>3</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>困难</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:142.0pt">			<p>4</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>极难</p>			</td>			<td style="vertical-align:top; width:142.05pt">			<p>&nbsp;</p>			</td>		</tr>	</tbody></table><p>【背景描述】</p><p>XX企业，为加强信息化建设，组建了企业内部网络，且对内部网络做了安全防护，现我们需要绕过这些安全设备，如IDS、IPS、防火墙等，访问到内部网络。</p><p>通过stunnel的代理隧道技术对内网进行穿透，来达到目的</p><p>&nbsp;【实训设备】</p><table border="1" cellspacing="0" style="width:0px">	<tbody>		<tr>			<td style="vertical-align:top; width:146.65pt">			<p>产品型号</p>			</td>			<td style="vertical-align:top; width:166.25pt">			<p>产品描述</p>			</td>			<td style="vertical-align:top; width:69.8pt">			<p>数量</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:146.65pt">			<p>PY-P8</p>			</td>			<td style="vertical-align:top; width:166.25pt">			<p>实训室安全、应用环境实训平台</p>			</td>			<td style="vertical-align:top; width:69.8pt">			<p>1</p>			</td>		</tr>	</tbody></table><p>【预备知识】</p><p>Stunnel是一个自由的跨平台软件，用于提供全局的TLS/SSL服务。针对本身无法进行TLS或SSL通信的客户端及服务器，Stunnel可提供安全的加密连接。该软件可在许多操作系统下运行，包括Unix-like系统，以及Windows。Stunnel依赖于某个独立的库，如OpenSSL或者SSLeay，以实现TLS或SSL协议。</p><p>【实验原理】</p><p>&nbsp;三个IP，一个是目标IP 192.168.8.254，其余两个主机IP为BT5和kali，192.168.8.167和192.168.8.176，其中192.168.8.167作为stunnel服务器，192.168.8.176作为客户端，只要连接到192.168.8.176的2323端口就会转到192.168.8.167的端口，只要连接到192.168.8.167的2323端口就会转到192.168.8.254。这将实现了跳两次，而且通信加密连到目标主机。</p><p>【实验步骤】</p><div>&nbsp; 网络拓扑：kali--bt5--01-server2003<span style="white-space:pre"> </span></div><div><p>&nbsp; bt5&nbsp;<br />&nbsp; 用户：root<br />&nbsp; 密码：toor</p><p>&nbsp; windows server 2003<br />&nbsp; 用户：administrator<br />&nbsp; 密码：123456</p><p>&nbsp; kali<br />&nbsp; 用户：root<br />&nbsp; 密码：toor</p></div><p><strong>【第一步】点击启动选项，启动实验虚拟机。</strong></p><p><strong>【第二步】获取操作机和靶机的IP</strong></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 靶机：<strong>ifconfig</strong></p><p>&nbsp;</p><p>操作机：ifconfig&nbsp;</p><p>&nbsp;&nbsp;&nbsp; &nbsp;<img src="api/attachment?type=courseDocument&amp;id=1311" style="height:248px; width:518px" /></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 跳板机：ifconfig</p><p>&nbsp; <img src="api/attachment?type=courseDocument&amp;id=1309" style="height:341px; width:494px" /></p><p><strong>【第三步】在靶机Window2003系统内开启Telnet服务</strong></p><p>在开始菜单中打开-&gt;运行输入services.msc打开服务，找到Telnet服务并启动。</p><p><strong>【第四步】创建配置文件目录和配置文件及生成证书</strong></p><p>【备注】：&ldquo;[]:&rdquo;后输入默认为空</p><p><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </strong><strong>【用到的命令】</strong></p><p>mkdir /etc/stunnel #创建配置文件目录</p><p>touch /etc/stunnel/stunnel.conf #创建配置文件</p><p>openssl req -new -x509 -days 365 -nodes -config /etc/ssl/openssl.cnf -out stunnel.pem -keyout stunnel.pem #生成pem格式的证书</p><p><strong>【参数说明】</strong></p><p>【-x509】: 生成自签名证书</p><p>【-new】：生成证书请求</p><p>【-keyout】：指定生成的密钥名称</p><p>【-config】：参数文件，默认是/etc/ssl/openssl.cnf，根据系统不同位置不同。该文件包含生成req时的参数，当在命令行没有指定时，则采用该文件中的默认值。</p><p>【-days】: 指定签名证书有效期限</p><p><strong>【第五步】在跳板机BT5配置服务端stunnel配置文件</strong></p><p><strong>【用到的命令】</strong></p><p>【cd &nbsp;/etc/stunnel/】：进入到工具目录</p><p>【vi stunnel.conf】：编辑配置文件</p><p>【cert = /etc/stunnel/stunnel.pem】：配置指定证书所在位置</p><p>【chroot = /var/log/stunnel/】：配置运行时缓存目录位置</p><p>【pid = /stunnel.pid】 ：配置运行时进程ID依赖文件</p><p>【[telnets]】：配置Telnet</p><p>【accept = 2323】：指定Telnet动作请求端口</p><p>【connect = 192.168.8.1254:23】：指定目标Telnet的ip地址</p><p>&nbsp;</p><p><strong>【第六步】创建缓存目录</strong></p><p><strong>【用到的命令】</strong></p><p>&nbsp;mkdir /var/log/stunnel/</p><p><strong>【第七步】启动服务端stunnel. </strong></p><p><strong>【用到的命令】</strong></p><p>stunnel /etc/stunnel/stunnel.conf#启动stunnel服务</p><p><strong>【第八步】查看stunnel运行状态 </strong></p><p><strong>【用到的命令】</strong></p><p>netstat -tulnp | grep 2323</p><p><strong>【第九步】在客户端（操作机）创建配置文件</strong></p><p><strong>【用到的命令】</strong></p><p>touch /etc/stunnel/stunnel.conf #创建配置文件</p><p><strong>【第十步】配置客户端及stunnel的connect的ip为服务端ip。</strong></p><p>【备注】：其他配置与服务端相同。</p><p><strong>【用到的命令】</strong></p><p>【chroot = /var/log/stunnel/】：配置运行时缓存目录位置</p><p>【pid = /stunnel.pid】：配置运行时进程ID依赖文件</p><p>【client = yes】：指定模式为客户端</p><p>【[telnets]】：</p><p>【accept = 2323】：指定端口Telnet默认为2323</p><p>【connect = 192.168.8.167:2323】：指定连接的目标地址</p><p><strong>【第十一步】创建缓存目录</strong></p><p><strong>【用到的命令】</strong></p><p>mkdir /var/log/stunnel/ #创建运行时缓存目录</p><p><strong>【第十二步】启动客户端stunnel</strong></p><p><strong>【用到的命令】 &nbsp;</strong></p><p>stunnel /etc/stunnel/stunnel.conf</p><p><strong>【第十三步】穿透到目标主机</strong></p><p><strong>【备注】：</strong>客户端192.168.8.176，通过本地[127.0.0.1]即指定的 192.168.8.176的2323端口，只要连接本地2323端口就会转到192.168.8.167的端口，只要连接到192.168.8.167的2323端口就会转到192.168.8.254，中间通过stunnel隧道代理转发了两次，而且通信过程中实现加密连到目标主机，成功穿透到目标网络。</p><p>&nbsp;</p><p>实验结束，关闭虚拟机。</p>
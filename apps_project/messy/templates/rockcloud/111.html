<p></p><p>二层网络Sniffer监听安全攻防<strong> </strong></p><p>&nbsp;</p><p><strong>任务环境说明：</strong></p><p>服务器场景：WebServ2003（用户名：administrator；密码：空）</p><p>服务器场景操作系统：Microsoft Windows2003 Server</p><p>服务器场景安装服务/工具1：Apache2.2；</p><p>服务器场景安装服务/工具2：Php6；</p><p>服务器场景安装服务/工具3：Microsoft SqlServer2000；</p><p>服务器场景安装服务/工具4：EditPlus；</p><p>网络拓扑：01-WebServ2003--02-AttWinXp</p><p>windows server 2003<br />用户：administrator<br />密码：空</p><p>1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PC2（虚拟机：WindowsXP）打开Ethereal，监听到PC2（虚拟机：WindowsXP）通过Internet Explorer访问服务器场景的HTTP请求数据包，通过对该数据包的分析，确定该数据包中含有PC2（虚拟机：WindowsXP）通过Internet Explorer访问服务器场景的用户名、密码，并将存放用户名的变量名和存放密码的变量名作为Flag（形式：存放用户名的变量名&amp;存放密码的变量名）提交；</p><p>&nbsp;</p><p>WindowsXP打开Ethereal</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;<img src="api/attachment?type=courseDocument&amp;id=1600" style="height:185px; width:365px" /></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="api/attachment?type=courseDocument&amp;id=1592" style="height:212px; width:576px" /></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="api/attachment?type=courseDocument&amp;id=1620" style="height:432px; width:494px" /></p><p>查看server2003的ip地址</p><p>使用xp的ie浏览器访问server2003的服务器场景</p><p>停止抓包</p><p>找到存放用户名的变量名和存放密码的变量名</p><p>&nbsp;</p><p>Flag：</p><p>usernm&amp;passwd</p><p>&nbsp;</p><p>&nbsp;</p><p>2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 在PC2（虚拟机：WindowsXP）和PY-B7中的WebServ2003服务器场景之间建立IPSec VPN，阻止Sniffer监听渗透测试，PC2（虚拟机：WindowsXP）通过Ping访问WebServ2003服务器，将第1个数据包的回显结果作为Flag提交；</p><p>&nbsp;</p><p>&nbsp;WindowsXP和PY-B7中的WebServ2003服务器场景之间建立IPSec VPN</p><p>&nbsp;<img src="api/attachment?type=courseDocument&amp;id=1622" style="height:469px; width:395px" /></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="api/attachment?type=courseDocument&amp;id=1652" style="height:347px; width:503px" /></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="api/attachment?type=courseDocument&amp;id=1611" style="height:346px; width:496px" /></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="api/attachment?type=courseDocument&amp;id=1589" style="height:346px; width:502px" /></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="api/attachment?type=courseDocument&amp;id=1595" style="height:347px; width:505px" /></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="api/attachment?type=courseDocument&amp;id=1630" style="height:351px; width:495px" /></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="api/attachment?type=courseDocument&amp;id=1615" style="height:325px; width:379px" /></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="api/attachment?type=courseDocument&amp;id=1650" style="height:346px; width:493px" /></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="api/attachment?type=courseDocument&amp;id=1594" style="height:342px; width:501px" /></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="api/attachment?type=courseDocument&amp;id=1641" style="height:384px; width:520px" /></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="api/attachment?type=courseDocument&amp;id=1614" style="height:380px; width:514px" /></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="api/attachment?type=courseDocument&amp;id=1597" style="height:445px; width:430px" /></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="api/attachment?type=courseDocument&amp;id=1629" style="height:452px; width:427px" /></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="api/attachment?type=courseDocument&amp;id=1609" style="height:270px; width:576px" /></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Server2003也进行相同的配置</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="api/attachment?type=courseDocument&amp;id=1621" style="height:499px; width:576px" /></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="api/attachment?type=courseDocument&amp;id=1623" style="height:454px; width:576px" /></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="api/attachment?type=courseDocument&amp;id=1617" style="height:391px; width:502px" /></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="api/attachment?type=courseDocument&amp;id=1625" style="height:393px; width:504px" /></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="api/attachment?type=courseDocument&amp;id=1627" style="height:391px; width:502px" /></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="api/attachment?type=courseDocument&amp;id=1632" style="height:373px; width:501px" /></p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="api/attachment?type=courseDocument&amp;id=1601" style="height:328px; width:484px" /></p><p>WindowsXP）通过Ping访问WebServ2003服务器，将第1个数据包的回显结果作为Flag</p><p>Flag：</p><p>Negotiating IP Security.</p><p>&nbsp;</p><p>&nbsp;</p><p>3.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PC2（虚拟机：WindowsXP）再次打开Ethereal，监听PC2（虚拟机：WindowsXP）访问WebServ2003服务器场景HTTP流量，验证此时PC2（虚拟机：WindowsXP）Ethereal中无法明文显示PC2（虚拟机：WindowsXP）访问WebServ2003服务器场景的HTTP流量，并将Ethereal中显示该流量Protocol名称作为Flag提交</p><p>&nbsp;</p><p>再次打开Ethereal，监听PC2（虚拟机：WindowsXP）访问WebServ2003服务器场景HTTP流量</p><p>Flag：ESP</p><p>&nbsp;</p>
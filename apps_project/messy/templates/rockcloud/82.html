<p></p><p>【教学资源类别】</p><table border="1" cellspacing="0" style="width:100.0%">	<tbody>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>序号</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>类别</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>打勾&radic;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>1</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>学习资源</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&radic;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>2</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>单兵模式赛题资源</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>3</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>分组对抗赛题资源</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&nbsp;</p>			</td>		</tr>	</tbody></table><p>&nbsp;【教学资源名称】&nbsp;</p><p>&nbsp; 应用层协议分析-通过IIS进行HTTPS协议分析</p><p>&nbsp;【教学资源分类】</p><table border="1" cellspacing="0" style="width:100.0%">	<tbody>		<tr>			<td style="height:14.0pt; width:25.1%">			<p>一级大类</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>二级大类</p>			</td>			<td style="height:14.0pt; width:19.12%">			<p>打勾&radic;</p>			</td>		</tr>		<tr>			<td rowspan="5" style="height:14.0pt; width:25.1%">			<p>1.安全标准</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>法律法规</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>行业标准</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>安全意识</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>应急响应</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>安全评估</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td rowspan="2" style="height:14.0pt; width:25.1%">			<p>2.系统安全</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>Windows操作系统安全配置</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>Linux操作系统安全配置</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td rowspan="2" style="height:14.0pt; width:25.1%">			<p>3.网络安全</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>网络设备安全</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>网络协议分析</p>			</td>			<td style="height:14.0pt; width:19.12%">			<p>&radic;</p>			</td>		</tr>		<tr>			<td rowspan="7" style="height:14.0pt; width:25.1%">			<p>4.应用安全</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>Web应用安全</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>数据库安全</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>中间件应用安全</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>应用层协议分析</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>移动应用安全</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>VPN应用</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>恶意代码分析</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td rowspan="2" style="height:14.0pt; width:25.1%">			<p>5.密码学</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>密码学原理</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>密码学应用</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td rowspan="3" style="height:14.0pt; width:25.1%">			<p>6.渗透测试</p>			</td>			<td style="height:14.0pt; width:55.78%">			<p>常用工具</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>脚本编写</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>		<tr>			<td style="height:14.0pt; width:55.78%">			<p>报告编写</p>			</td>			<td style="height:14.0pt; width:19.12%">&nbsp;</td>		</tr>	</tbody></table><p>【难度说明】</p><table border="1" cellspacing="0" style="width:100.0%">	<tbody>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>序号</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>难度等级</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>打勾&radic;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>1</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>简单</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&radic;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>2</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>一般</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>3</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>困难</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&nbsp;</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:33.32%">			<p>4</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>极难</p>			</td>			<td style="vertical-align:top; width:33.34%">			<p>&nbsp;</p>			</td>		</tr>	</tbody></table><p>【背景描述】</p><p>XX企业，为加强信息化建设，组建了企业内部网络，用于自身网站的建设，小王是该企业新进网管，承担网络的管理工作。</p><p>现该企业网络存在如下需求：</p><p>通过企业网络NIDS分析，经常发现网络中出现假冒的企业网络WWW服务，造成客户端遭受木马攻击，针对此问题，需要提出针对此攻击的解决方案，目前较为合适的方案是使用HTTP Over SSL（HTTPS）。</p><p>【实训设备】</p><table border="1" cellspacing="0">	<tbody>		<tr>			<td style="vertical-align:top; width:4.0cm">			<p>产品型号</p>			</td>			<td style="vertical-align:top; width:199.5pt">			<p>产品描述</p>			</td>			<td style="vertical-align:top; width:69.8pt">			<p>数量</p>			</td>		</tr>		<tr>			<td style="vertical-align:top; width:4.0cm">			<p>PY-P8</p>			</td>			<td style="vertical-align:top; width:199.5pt">			<p>实训室安全、应用环境实训平台</p>			</td>			<td style="vertical-align:top; width:69.8pt">			<p>1</p>			</td>		</tr>	</tbody></table><p>【预备知识】</p><p>Secure Socket Layer（SSL）俗称安全套接层，是由Netscape Communitcation于1990年开发，用于保障Word Wide Web（WWW）通讯的安全。主要任务是提供私密性，信息完整性和身份认证。1994年改版为SSLv2，1995年改版为SSLv3。</p><p>Transport Layer Security（TLS）标准协议由IETF于1999年颁布，整体来说TLS非常类似与SSLv3，只是对SSLv3做了些增加和修改。</p><p>SSL协议概述：SSL是一个不依赖于平台和运用程序的协议，用于保障运用安全，SSL在传输层和运用层之间，就像运用层连接到传输层的一个插口。</p><p>SSL连接的建立有两个主要的阶段：</p><p>第一阶段：Handshake phase（握手阶段）</p><p>a、协商加密算法</p><p>b、认证服务器</p><p>c、建立用于加密和HMAC用的密钥</p><p>第二阶段：Secure data transfer phase（安全的数据传输阶段）</p><p>在已经建立的SSL连接里安全的传输数据</p><p>SSL是一个层次化的协议，最底层是SSL record protocol（SSL纪录协议），record protocol包含一些信息类型或者说是协议，用于完成不同的任务。</p><p>下面我们对SSL/TLS里边的每一个协议的主要作用进行介绍：</p><p>一、Record Protocol：（记录协议）是主要的封装协议，它传输不同的高层协议和运用层数据。它从上层用户协议获取信息并且传输，执行需要的任务，例如：分片，压缩，运用MAC和加密，并且传输最终数据。它也执行反向行为，解密，确认，解压缩和重组装来获取数据。记录协议包括四个上层客户协议，Handshake（握手）协议，Alert（告警）协议，Change Cipher Spec（修改密钥说明）协议，Application Data（运用层数据）协议。</p><p>二、Handshake Protocols： 握手协议负责建立和恢复SSL会话。它由三个子协议组成。</p><p>a、Handshake Protocol（握手协议）协商SSL会话的安全参数。</p><p>b、Alert Protocol（告警协议） 一个事务管理协议，用于在SSL对等体间传递告警信息。告警信息包括，1.errors（错误），2.exception conditions（异常状况）例如：错误的MAC或者解密失败，3.notification （通告）例如：会话终止。</p><p>c、Change Cipher Spec Protocol（修改密钥说明）协议，用于在后续记录中通告密钥策略转换。</p><p>Handshake protocols（握手协议）用于建立SSL客户和服务器之间的连接，这个过程由如下这几个主要任务组成：</p><p>1、Negotiate security capabilities（协商安全能力）：处理协议版本和加密算法。</p><p>2、Authentication（认证）：客户认证服务器，当然服务器也可以认证客户。</p><p>3、Key exchange（密钥交换）：双方交换用于产生master keys（主密钥）的密钥或信息。</p><p>4、Key derivation（密钥引出）：双方引出master secret（主秘密），这个主秘密用于产生用于数据加密和MAC的密钥。</p><p>三、Application Data protocol： （运用程序数据协议）处理上层运用程序数据的传输。</p><p>【实验步骤】</p><p>网络拓扑：BackTrack5--Windows2003--Windows2003</p><p>bt5&nbsp;<br />用户：root<br />密码：toor</p><p>windows server 2003<br />用户：administrator<br />密码：空</p><p>第一步：配置服务器和客户机的IP地址</p><p>服务器：192.168.1.121</p><p>客户机：192.168.1.111</p><p>第二步：确保服务器安装了以下服务：</p><p>1、WWW服务</p><p>2、证书服务</p><p>3、DNS服务</p><p>（图略）</p><p>第三步：无论在客户机还是服务器，均需要获得CA（证书服务器）的根证书；要信任从这个证书颁发机构颁发的证书，安装此 CA 证书链。</p><p>第四步：无论在客户机还是服务器，安装这个CA证书链；</p><p>&nbsp;</p><p>第五步：无论在客户机还是服务器，确认已经安装了CA的根证书；</p><p>第六步：为服务器来申请Server个人证书；</p><p>第七步：要提交一个保存的申请到 CA，在&ldquo;保存的申请&rdquo;框中粘贴一个由外部源(如 Web 服务器)生成的 base-64 编码的 CMC 或 PKCS #10 证书申请或 PKCS #7 续订申请。</p><p>第八步：在CA颁发该Server证书，然后在服务器对该Server证书进行下载、安装；</p><p>&nbsp;</p><p>第九步：客户机在通过HTTP Over SSL访问公司的电子商务网站的时候，客户机对服务器的认证需要确认3点：</p><p>第一：该证书是否是由可信任的CA颁发；</p><p>第二：该证书是否在有效期之内；</p><p>第三：证书颁发对象是否与站点名称匹配；</p><p>比如：客户机通过IP地址访问服务器，就没有使用与证书颁发对象相同的名称；</p><p>第十步：现在需要使用与证书颁发对象相同的名称，才可以正常访问WWW服务；所以需要在DNS服务中创建一条映射记录，将证书颁发对象的名称同服务器的IP地址进行映射（www.taojin.com -&gt; 192.168.1.121），然后将客户端的DNS服务指向DNS服务器的IP地址，才能通过Internet Explorer正常访问WWW服务</p><p>第十一步：打开WireShark程序，并配置过滤条件</p><p>第十二步：在客户机Internet Explorer中访问服务器的HTTPS服务以后，打开WireShark程序，对Client Hello信息进行分析</p><p>第十三步：打开WireShark程序，对Server Hello信息进行分析</p><p>第十四步：打开WireShark程序，对Client Key Exchange信息进行分析</p><p>第十五步：打开WireShark程序，对Server Certificate信息进行分析</p><p>第十六步：打开WireShark程序，对Server Hello Done 信息进行分析</p><p>第十七步：打开WireShark程序，对Change Cipher Spec信息进行分析</p><p>&nbsp;</p><p>&nbsp;</p><p>实验结束，关闭虚拟机。</p>